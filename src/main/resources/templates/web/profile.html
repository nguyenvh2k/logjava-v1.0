<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>Log Java</title>
    <th:block th:insert="~{/layout/logjava::link}"></th:block>
    <th:block th:insert="~{/layout/logjava::head/script}"></th:block>
</head>

<body>
    <div class="wrap">
        <header th:replace="~{/layout/logjava::header}"></header>
        <section class="site-section py-sm">
            <div class="container">
                <div class="row blog-entries">
                    <div class="col-md-12 col-lg-8 main-content">
                        <section style="background-color: #eee;">
                            <div class="container py-5">
                              <div class="row">
                                <div class="col">
                                  <nav aria-label="breadcrumb" class="bg-light rounded-3 p-3 mb-4">
                                    <ol class="breadcrumb mb-0">
                                      <li class="breadcrumb-item active" aria-current="page">Trang cá nhân</li>
                                    </ol>
                                  </nav>
                                </div>
                              </div>
                          
                              <div class="row">
                                <div class="col-lg-4">
                                  <div class="card mb-4">
                                    <div class="card-body text-center">
                                      <img src="https://cf.shopee.vn/file/84c835945fa087b972cc0cddd077cb61" alt="avatar"
                                        class="rounded-circle img-fluid" style="width: 150px;">
                                      <h5 class="my-3" th:text="${userSession.username}"></h5>
                                      <button class="btn btn-success" id="avatar">Thay đổi avatar</button>
                                      <p class="text-muted mb-1">Backend Developer</p>
                                      <div class="d-flex justify-content-center mb-2">
                                        
                                        <button type="button" class="btn btn-primary">Follow</button>
                                        <button type="button" class="btn btn-outline-primary ms-1">Message</button>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="card mb-4 mb-lg-0">
                                    <div class="card-body p-0">
                                      <ul class="list-group list-group-flush rounded-3">
                                        <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                                          <i class="fa fa-github fa-lg" style="color: #333333;"></i>
                                          <p class="mb-0">link</p>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                                          <i class="fa fa-twitter fa-lg" style="color: #55acee;"></i>
                                          <p class="mb-0">link</p>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                                          <i class="fa fa-instagram fa-lg" style="color: #ac2bac;"></i>
                                          <p class="mb-0">link</p>
                                        </li>
                                        <li class="list-group-item d-flex justify-content-between align-items-center p-3">
                                          <i class="fa fa-facebook-f fa-lg" style="color: #3b5998;"></i>
                                          <p class="mb-0">link</p>
                                        </li>
                                      </ul>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-lg-8">
                                  <div class="card mb-4">
                                    <div class="card-body">
                                      <div class="row">
                                        <div class="col-sm-3">
                                          <p class="mb-0">Tên</p>
                                        </div>
                                        <div class="col-sm-9">
                                          <p class="text-muted mb-0" th:text="${userSession.fullname}"></p>
                                        </div>
                                      </div>
                                      <hr>
                                      <div class="row">
                                        <div class="col-sm-3">
                                          <p class="mb-0">Email</p>
                                        </div>
                                        <div class="col-sm-9">
                                          <p class="text-muted mb-0" th:text="${userSession.email}"></p>
                                        </div>
                                      </div>
                                      <hr>
                                      <div class="row">
                                        <div class="col-sm-3">
                                          <p class="mb-0">Đia chỉ</p>
                                        </div>
                                        <div class="col-sm-9">
                                          <p class="text-muted mb-0">xxxx</p>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                  <div class="row">
                                    <div class="col-md-6">
                                      <div class="card mb-4 mb-md-0">
                                        <div class="card-body">
                                          <p class="mb-4"><span class="text-primary font-italic me-1">assigment</span> Project Status
                                          </p>
                                          <p class="mb-1" style="font-size: .77rem;">Web Design</p>
                                          <div class="progress rounded" style="height: 5px;">
                                            <div class="progress-bar" role="progressbar" style="width: 80%" aria-valuenow="80"
                                              aria-valuemin="0" aria-valuemax="100"></div>
                                          </div>
                                          <p class="mt-4 mb-1" style="font-size: .77rem;">Website Markup</p>
                                          <div class="progress rounded" style="height: 5px;">
                                            <div class="progress-bar" role="progressbar" style="width: 72%" aria-valuenow="72"
                                              aria-valuemin="0" aria-valuemax="100"></div>
                                          </div>
                                          <p class="mt-4 mb-1" style="font-size: .77rem;">One Page</p>
                                          <div class="progress rounded" style="height: 5px;">
                                            <div class="progress-bar" role="progressbar" style="width: 89%" aria-valuenow="89"
                                              aria-valuemin="0" aria-valuemax="100"></div>
                                          </div>
                                          <p class="mt-4 mb-1" style="font-size: .77rem;">Mobile Template</p>
                                          <div class="progress rounded" style="height: 5px;">
                                            <div class="progress-bar" role="progressbar" style="width: 55%" aria-valuenow="55"
                                              aria-valuemin="0" aria-valuemax="100"></div>
                                          </div>
                                          <p class="mt-4 mb-1" style="font-size: .77rem;">Backend API</p>
                                          <div class="progress rounded mb-2" style="height: 5px;">
                                            <div class="progress-bar" role="progressbar" style="width: 66%" aria-valuenow="66"
                                              aria-valuemin="0" aria-valuemax="100"></div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                    <div class="col-md-6">
                                      <div class="card mb-4 mb-md-0">
                                        <div class="card-body">
                                          <p class="mb-4"><span class="text-primary font-italic me-1">assigment</span> Project Status
                                          </p>
                                          <p class="mb-1" style="font-size: .77rem;">Web Design</p>
                                          <div class="progress rounded" style="height: 5px;">
                                            <div class="progress-bar" role="progressbar" style="width: 80%" aria-valuenow="80"
                                              aria-valuemin="0" aria-valuemax="100"></div>
                                          </div>
                                          <p class="mt-4 mb-1" style="font-size: .77rem;">Website Markup</p>
                                          <div class="progress rounded" style="height: 5px;">
                                            <div class="progress-bar" role="progressbar" style="width: 72%" aria-valuenow="72"
                                              aria-valuemin="0" aria-valuemax="100"></div>
                                          </div>
                                          <p class="mt-4 mb-1" style="font-size: .77rem;">One Page</p>
                                          <div class="progress rounded" style="height: 5px;">
                                            <div class="progress-bar" role="progressbar" style="width: 89%" aria-valuenow="89"
                                              aria-valuemin="0" aria-valuemax="100"></div>
                                          </div>
                                          <p class="mt-4 mb-1" style="font-size: .77rem;">Mobile Template</p>
                                          <div class="progress rounded" style="height: 5px;">
                                            <div class="progress-bar" role="progressbar" style="width: 55%" aria-valuenow="55"
                                              aria-valuemin="0" aria-valuemax="100"></div>
                                          </div>
                                          <p class="mt-4 mb-1" style="font-size: .77rem;">Backend API</p>
                                          <div class="progress rounded mb-2" style="height: 5px;">
                                            <div class="progress-bar" role="progressbar" style="width: 66%" aria-valuenow="66"
                                              aria-valuemin="0" aria-valuemax="100"></div>
                                          </div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </section>
                    </div>
                    <div class="col-md-12 col-lg-4 sidebar">
                        <div th:replace="~{/layout/logjava::search}"></div>
                        <div th:replace="~{/layout/logjava::avatar}"></div>
                        <div th:replace="~{/layout/logjava::popular-post}"></div>
                        <div th:replace="~{/layout/logjava::categories}"></div>
                        <div th:replace="~{/layout/logjava::tag}"></div>
                    </div>
                </div>
            </div>
        </section>
        <footer th:replace="~{layout/logjava::footer}"></footer>
    </div>
    <div class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <i class="fa fa-info-circle text-info p-1" aria-hidden="true"></i>
                    <h5 class="modal-title">Thay đổi ảnh đại diện</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form method="POST" enctype="multipart/form-data" id="fileUploadForm">
                        <input type="file" name="files" id="fImage" accept=".jpg, .png" /><br />
                        <input type="submit" class="btn btn-success mt-2 mb-2" value="Upload" id="submitButton" />
                        <input type="hidden" id="result" />
                        <img alt="avatar" id="pic1" style="object-fit: cover;height: 100px;width: 100px;border-radius: 50%;">
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger text-center" id="delete">OK</button>
                    <button type="button" class="btn btn-secondary text-center" data-dismiss="modal" id="noDelete">Huỷ</button>
                </div>
            </div>
        </div>
    <script th:inline="javascript" type="text/javascript">
        var modal = $('.modal');
        $('#avatar').click(function (e) {
            e.preventDefault();
            modal.show();
            $('#submitButton').click(function(e){
                e.preventDefault();
                ajaxSubmitForm();
            });
            $('#delete').click(function (e1) {
                e1.preventDefault();
                modal.hide();
            });
            $('#noDelete').click(function () {
                modal.hide();
            });
            $(window).on('click', function (e) {
                if ($(e.target).is('.modal')) {
                    modal.hide();
                }
            });
        })
        function ajaxSubmitForm() {
      // Get form
      var form = $('#fileUploadForm')[0];
      var data = new FormData(form);
      $("#submitButton").prop("disabled", true);
      $.ajax({
        type: "POST",
        enctype: 'multipart/form-data',
        url: "/api/v1/upload/image",
        data: data,
        // prevent jQuery from automatically transforming the data into a query string
        processData: false,
        contentType: false,
        cache: false,
        timeout: 1000000,
        success: function (data, textStatus, jqXHR) {
          console.log(data);
          $("#result").val(data);
          $("#pic1").attr("src", data);
        },
        error: function (jqXHR, textStatus, errorThrown) {
          console.log("ERROR : ", jqXHR.responseText);
        }
      });
    }
    </script>
    <th:block th:insert="~{layout/logjava::script}"></th:block>
</body>

</html>